(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{137:function(e,t,n){e.exports=n(261)},142:function(e,t,n){},259:function(e,t,n){},261:function(e,t,n){"use strict";n.r(t);var a,o=n(0),r=n.n(o),s=n(8),c=n.n(s),i=(n(142),n(19)),l=n(20),u=n(28),m=n(27),b=n(29),p=n(51),f=n(24),h=n(263),y=n(266),d=n(267),O=n(73),j=n.n(O),g=n(13),v=n(47),E=n(262),S=n(265),w={labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:16},sm:{span:16}}},k={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:14},sm:{span:14}}},C=E.a.Item,I=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).onSubmit=function(e){e.preventDefault();var t=Object(v.a)(n),a=t.stores.conn,o=t.props.form,r=o.getFieldsValue().message;a.send(JSON.stringify({type:0,message:r})),o.setFieldsValue({message:""})},n}return Object(b.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form;return r.a.createElement(p.a,null,r.a.createElement(E.a,{onSubmit:this.onSubmit},r.a.createElement(C,Object.assign({label:"message"},w),e.getFieldDecorator("message",{})(r.a.createElement(S.a,null)))))}},{key:"stores",get:function(){return this.props.stores}}]),t}(o.Component),W=Object(g.b)("stores")(Object(g.c)(E.a.create()(I))),N=n(31),R=E.a.Item,L=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).onSubmit=function(e){e.preventDefault();var t=Object(v.a)(n),a=t.stores,o=a.conn,r=a.roomInfo,s=t.props.form;r||y.a.error("You haven't joined a room");var c=s.getFieldsValue().message;o.send(JSON.stringify({type:5,message:c})),s.setFieldsValue({message:""})},n}return Object(b.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form;return r.a.createElement(p.a,null,r.a.createElement(E.a,{onSubmit:this.onSubmit},r.a.createElement(R,Object.assign({label:"message"},k),e.getFieldDecorator("message",{})(r.a.createElement(S.a,null)))))}},{key:"stores",get:function(){return this.props.stores}}]),t}(o.Component),M=Object(g.b)("stores")(Object(g.c)(E.a.create()(L))),D=n(99),_=n.n(D),F=n(134),x=n(101),J=n(264),P={visible:!1,title:"New Modal",destroyOnClose:!0,body:r.a.createElement(function(){return r.a.createElement("div",null,"Body")},null),footer:null},z=function(e){return function(t){function n(){var e,t;Object(i.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(t=Object(u.a)(this,(e=Object(m.a)(n)).call.apply(e,[this].concat(o)))).state=Object(x.a)({},P),t._showModal=function(e,n){t.setState(Object(x.a)({visible:!0},e))},t.handleCancel=function(){t.setState({visible:!1})},t.modal={show:t._showModal,close:t.handleCancel},t}return Object(b.a)(n,t),Object(l.a)(n,[{key:"render",value:function(){var t=this.state,n=t.body,a=Object(F.a)(t,["body"]);return r.a.createElement(o.Fragment,null,r.a.createElement(e,Object.assign({},this.props,{modal:this.modal})),r.a.createElement(J.a,Object.assign({},a,{onCancel:this.handleCancel}),n))}}]),n}(o.Component)},A=n(11),B=E.a.Item,V=function(){return r.a.createElement("div",null,r.a.createElement(h.a,{title:"Private Room"},r.a.createElement(G,null),r.a.createElement(T,null),r.a.createElement(M,null)))},G=Object(g.b)("stores")(Object(g.c)(function(e){var t=e.stores,n=t.roomInfo;return r.a.createElement("div",{className:_.a["button-join-area"]},!n&&r.a.createElement(N.a,{onClick:function(){t.conn.send(JSON.stringify({type:9}))},type:"primary"},"Quick join"),r.a.createElement(N.a,{onClick:function(){var e=t.conn;n?e.send(JSON.stringify({type:3})):e.send(JSON.stringify({type:1}))},type:"primary",style:{marginLeft:24}},n?"Leave room":"Create room"),r.a.createElement(H,null),r.a.createElement("div",null,n&&r.a.createElement("span",{style:{paddingLeft:14}},"roomId: ",n.roomId)))})),T=Object(g.b)("stores")(Object(g.c)(function(e){var t=e.stores.roomMessages;return r.a.createElement("div",{className:_.a["chat-body"]},Object(A.l)(t).map(function(e,t){return r.a.createElement("li",{key:"mess-".concat(t)},e.message)}))})),H=z(Object(g.b)("stores")(Object(g.c)(function(e){var t=e.stores,n=e.modal;return t.roomInfo?r.a.createElement(r.a.Fragment,null):r.a.createElement(N.a,{onClick:function(){n.show({title:"Input Room Code",body:r.a.createElement(q,{close:n.close})})},type:"primary",style:{marginLeft:24}},"Join room")}))),q=Object(g.b)("stores")(Object(g.c)(E.a.create()(function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).onSubmitForm=function(e){e.preventDefault();var t=n.props,a=t.form,o=t.stores,r=t.close;a.validateFields(["code"],function(e,t){e||(console.log("values: ",t),o.conn.send(JSON.stringify({type:7,roomId:t.code})),r&&r())})},n}return Object(b.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form;return r.a.createElement(E.a,{onSubmit:this.onSubmitForm},r.a.createElement(B,Object.assign({label:"code"},w),e.getFieldDecorator("code",{rules:[{type:"string",required:!0,whitespace:!0,message:"Code could not be empty"}]})(r.a.createElement(S.a,null))),r.a.createElement(B,null,r.a.createElement(p.a,{type:"flex",justify:"center"},r.a.createElement(N.a,{htmlType:"submit",type:"primary"},"JOIN"))))}}]),t}(o.Component)))),Q=function(){return r.a.createElement(p.a,null,r.a.createElement($,null),r.a.createElement(f.a,{span:16},r.a.createElement(p.a,null,r.a.createElement(f.a,{span:4,className:j.a["left-side"]},r.a.createElement(U,null)),r.a.createElement(f.a,{span:20},r.a.createElement(Y,null)))),r.a.createElement(f.a,{span:8},r.a.createElement(V,null)))},U=function(){return r.a.createElement("div",null,r.a.createElement(h.a,{title:"Status"},r.a.createElement(K,null)))},Y=Object(g.b)("stores")(Object(g.c)(function(e){var t=e.stores.messages;return r.a.createElement("div",{className:j.a["left-side"]},r.a.createElement(h.a,{title:"Messages"},r.a.createElement("div",{className:j.a["chat-body"]},Object(A.l)(t).map(function(e,t){return r.a.createElement("li",{key:"mess-".concat(t)},e.message)})),r.a.createElement(W,null)))})),$=Object(g.b)("stores")(Object(g.c)(function(e){var t=e.stores;if(t.onRetryInitWS){y.a.loading("Retrying connection..",2.5).then(function(){1===t.conn.readyState&&y.a.success("Connection established")},function(){})}return r.a.createElement(r.a.Fragment,null)})),K=Object(g.b)("stores")(a=Object(g.c)(a=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={state:n.stores.conn.readyState},n.timerConnState=void 0,n}return Object(b.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timerConnState=setInterval(function(){return e.tick()},250)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerConnState)}},{key:"tick",value:function(){this.setState({state:this.stores.conn.readyState})}},{key:"render",value:function(){var e,t=this.state.state,n=this.stores.conn;switch(t){case n.CONNECTING:e=r.a.createElement(d.a,{status:"processing",text:"Processing"});break;case n.OPEN:e=r.a.createElement(d.a,{status:"success",text:"Connected"});break;case n.CLOSING:e=r.a.createElement(d.a,{status:"warning",text:"Closing"});break;case n.CLOSED:default:e=r.a.createElement(d.a,{status:"error",text:"Disconect"})}return r.a.createElement("li",null,e)}},{key:"stores",get:function(){return this.props.stores}}]),t}(o.Component))||a)||a,X=(n(259),function(){return r.a.createElement(Q,null)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z,ee,te,ne,ae,oe,re,se=n(40),ce=n(22),ie=(n(260),"ws://localhost:8080/ws"),le=new(Z=function(){function e(){Object(i.a)(this,e),Object(se.a)(this,"initWS",ee,this),Object(se.a)(this,"onRetryInitWS",te,this),Object(se.a)(this,"messages",ne,this),Object(se.a)(this,"roomMessages",ae,this),Object(se.a)(this,"roomInfo",oe,this),this.conn=void 0,Object(se.a)(this,"socketCloseListener",re,this);var t=new WebSocket(ie);t.addEventListener("message",this.onListenMessage.bind(this)),t.addEventListener("close",this.socketCloseListener),this.conn=t,this.initWS=!0}return Object(l.a)(e,[{key:"initWSInstance",value:function(){var e=new WebSocket(ie);e.addEventListener("message",this.onListenMessage.bind(this)),e.addEventListener("close",this.socketCloseListener),this.conn=e,this.initWS=!0,this.onRetryInitWS=!1}},{key:"onListenMessage",value:function(e){try{var t=JSON.parse(e.data);switch(t.type){case 2:this.joinRoom(t);break;case 4:this.leaveRoom(t);break;case 6:console.log("message from room: ",t),this.roomMessages.push(t);break;case 10:console.log("no rooms available");break;default:this.messages.push(t)}}catch(n){console.log("failed while listening message: ",n)}}},{key:"pushMessage",value:function(e){this.messages.push(e)}},{key:"joinRoom",value:function(e){var t=e.roomId;this.roomInfo={roomId:t},this.pushMessage(e)}},{key:"leaveRoom",value:function(e){this.roomInfo=void 0,this.pushMessage(e)}},{key:"WSOnlineState",get:function(){return!!this.conn&&this.conn.readyState}}]),e}(),ee=Object(ce.a)(Z.prototype,"initWS",[A.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),te=Object(ce.a)(Z.prototype,"onRetryInitWS",[A.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ne=Object(ce.a)(Z.prototype,"messages",[A.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ae=Object(ce.a)(Z.prototype,"roomMessages",[A.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),oe=Object(ce.a)(Z.prototype,"roomInfo",[A.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),Object(ce.a)(Z.prototype,"initWSInstance",[A.b],Object.getOwnPropertyDescriptor(Z.prototype,"initWSInstance"),Z.prototype),re=Object(ce.a)(Z.prototype,"socketCloseListener",[A.b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.roomInfo=void 0,e.conn&&(e.onRetryInitWS=!0,console.error("Websocket disconnected")),setTimeout(function(){return e.initWSInstance()},2e3)}}}),Object(ce.a)(Z.prototype,"pushMessage",[A.b],Object.getOwnPropertyDescriptor(Z.prototype,"pushMessage"),Z.prototype),Object(ce.a)(Z.prototype,"joinRoom",[A.b],Object.getOwnPropertyDescriptor(Z.prototype,"joinRoom"),Z.prototype),Object(ce.a)(Z.prototype,"leaveRoom",[A.b],Object.getOwnPropertyDescriptor(Z.prototype,"leaveRoom"),Z.prototype),Object(ce.a)(Z.prototype,"WSOnlineState",[A.c],Object.getOwnPropertyDescriptor(Z.prototype,"WSOnlineState"),Z.prototype),Z);c.a.render(r.a.createElement(g.a,{stores:le},r.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},73:function(e,t,n){e.exports={"left-side":"Home_left-side__29fAD","chat-body":"Home_chat-body__18Gfp"}},99:function(e,t,n){e.exports={"chat-body":"PrivateRoom_chat-body__1nm_7","button-join-area":"PrivateRoom_button-join-area__1PEB0"}}},[[137,1,2]]]);
//# sourceMappingURL=main.916047d8.chunk.js.map